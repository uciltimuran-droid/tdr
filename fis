-- MiwaFISH Script for Roblox Fish It
-- Created with a clean UI and comprehensive features

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- Main GUI
local MiwaFISH = Instance.new("ScreenGui")
MiwaFISH.Name = "MiwaFISH"
MiwaFISH.ResetOnSpawn = false
MiwaFISH.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 350, 0, 400)
MainFrame.Position = UDim2.new(0, 10, 0.5, -200)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true

-- Corner Radius
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = MainFrame

-- Header
local Header = Instance.new("Frame")
Header.Name = "Header"
Header.Size = UDim2.new(1, 0, 0, 40)
Header.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
Header.BorderSizePixel = 0

local HeaderCorner = Instance.new("UICorner")
HeaderCorner.CornerRadius = UDim.new(0, 8)
HeaderCorner.Parent = Header

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(0.7, 0, 1, 0)
Title.Position = UDim2.new(0, 10, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "MiwaFISH"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18
Title.Font = Enum.Font.GothamBold
Title.TextXAlignment = Enum.TextXAlignment.Left

-- Minimize Button
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Size = UDim2.new(0, 30, 0, 30)
MinimizeButton.Position = UDim2.new(1, -40, 0.5, -15)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
MinimizeButton.BorderSizePixel = 0
MinimizeButton.Text = "_"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.TextSize = 16
MinimizeButton.Font = Enum.Font.GothamBold

local MinimizeCorner = Instance.new("UICorner")
MinimizeCorner.CornerRadius = UDim.new(0, 4)
MinimizeCorner.Parent = MinimizeButton

-- Close Button (for UI management)
local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -80, 0.5, -15)
CloseButton.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
CloseButton.BorderSizePixel = 0
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 100, 100)
CloseButton.TextSize = 14
CloseButton.Font = Enum.Font.GothamBold

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 4)
CloseCorner.Parent = CloseButton

-- Content Frame
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, -20, 1, -60)
ContentFrame.Position = UDim2.new(0, 10, 0, 50)
ContentFrame.BackgroundTransparency = 1

-- Scrolling Frame
local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Name = "ScrollFrame"
ScrollFrame.Size = UDim2.new(1, 0, 1, 0)
ScrollFrame.BackgroundTransparency = 1
ScrollFrame.ScrollBarThickness = 4
ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 600)

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 8)
UIListLayout.Parent = ScrollFrame

-- Feature Toggles
local features = {
    FastFishing = false,
    AutoSell = false,
    AutoPerfect = false,
    AllShips = false
}

-- Islands Data
local islands = {
    "Starter Island",
    "Ice Island", 
    "Volcano Island",
    "Cave Island",
    "Sky Island",
    "Deep Sea Island"
}

-- Function to create toggle button
local function createToggle(name, text, position)
    local ToggleFrame = Instance.new("Frame")
    ToggleFrame.Name = name .. "Toggle"
    ToggleFrame.Size = UDim2.new(1, 0, 0, 40)
    ToggleFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    ToggleFrame.BorderSizePixel = 0
    
    local ToggleCorner = Instance.new("UICorner")
    ToggleCorner.CornerRadius = UDim.new(0, 6)
    ToggleCorner.Parent = ToggleFrame
    
    local ToggleLabel = Instance.new("TextLabel")
    ToggleLabel.Name = "Label"
    ToggleLabel.Size = UDim2.new(0.7, 0, 1, 0)
    ToggleLabel.Position = UDim2.new(0, 10, 0, 0)
    ToggleLabel.BackgroundTransparency = 1
    ToggleLabel.Text = text
    ToggleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    ToggleLabel.TextSize = 14
    ToggleLabel.Font = Enum.Font.Gotham
    ToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    local ToggleButton = Instance.new("TextButton")
    ToggleButton.Name = "Toggle"
    ToggleButton.Size = UDim2.new(0, 50, 0, 25)
    ToggleButton.Position = UDim2.new(1, -60, 0.5, -12.5)
    ToggleButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    ToggleButton.BorderSizePixel = 0
    ToggleButton.Text = "OFF"
    ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    ToggleButton.TextSize = 12
    ToggleButton.Font = Enum.Font.GothamBold
    
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 12)
    ButtonCorner.Parent = ToggleButton
    
    ToggleLabel.Parent = ToggleFrame
    ToggleButton.Parent = ToggleFrame
    
    return ToggleFrame, ToggleButton
end

-- Function to create button
local function createButton(name, text)
    local Button = Instance.new("TextButton")
    Button.Name = name
    Button.Size = UDim2.new(1, 0, 0, 40)
    Button.BackgroundColor3 = Color3.fromRGB(45, 100, 180)
    Button.BorderSizePixel = 0
    Button.Text = text
    Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.TextSize = 14
    Button.Font = Enum.Font.GothamBold
    
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 6)
    ButtonCorner.Parent = Button
    
    return Button
end

-- Create feature toggles
local FastFishingToggle, FastFishingButton = createToggle("FastFishing", "Fast Fishing", UDim2.new(0, 0, 0, 0))
local AutoSellToggle, AutoSellButton = createToggle("AutoSell", "Auto Sell", UDim2.new(0, 0, 0, 48))
local AutoPerfectToggle, AutoPerfectButton = createToggle("AutoPerfect", "Auto Perfect Catch", UDim2.new(0, 0, 0, 96))
local AllShipsToggle, AllShipsButton = createToggle("AllShips", "Unlock All Ships", UDim2.new(0, 0, 0, 144))

-- Create teleport buttons
local TeleportLabel = Instance.new("TextLabel")
TeleportLabel.Name = "TeleportLabel"
TeleportLabel.Size = UDim2.new(1, 0, 0, 30)
TeleportLabel.BackgroundTransparency = 1
TeleportLabel.Text = "Island Teleport"
TeleportLabel.TextColor3 = Color3.fromRGB(200, 200, 255)
TeleportLabel.TextSize = 16
TeleportLabel.Font = Enum.Font.GothamBold

-- Create island buttons
local islandButtons = {}
for i, islandName in pairs(islands) do
    local button = createButton(islandName .. "Button", "Teleport to " .. islandName)
    islandButtons[islandName] = button
end

-- Assemble UI
FastFishingToggle.Parent = ScrollFrame
AutoSellToggle.Parent = ScrollFrame
AutoPerfectToggle.Parent = ScrollFrame
AllShipsToggle.Parent = ScrollFrame

TeleportLabel.Parent = ScrollFrame

for _, button in pairs(islandButtons) do
    button.Parent = ScrollFrame
end

-- Parent all elements
ScrollFrame.Parent = ContentFrame
Header.Parent = MainFrame
Title.Parent = Header
MinimizeButton.Parent = Header
CloseButton.Parent = Header
ContentFrame.Parent = MainFrame
MainFrame.Parent = MiwaFISH
MiwaFISH.Parent = player:WaitForChild("PlayerGui")

-- Toggle functionality
local function updateToggle(button, state)
    if state then
        button.BackgroundColor3 = Color3.fromRGB(0, 170, 80)
        button.Text = "ON"
    else
        button.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
        button.Text = "OFF"
    end
end

-- Fast Fishing
FastFishingButton.MouseButton1Click:Connect(function()
    features.FastFishing = not features.FastFishing
    updateToggle(FastFishingButton, features.FastFishing)
    
    if features.FastFishing then
        -- Fast fishing implementation
        spawn(function()
            while features.FastFishing and wait(0.1) do
                pcall(function()
                    -- Simulate fast fishing by reducing wait times
                    local fishingEvents = game:GetService("ReplicatedStorage"):FindFirstChild("FishingEvents")
                    if fishingEvents then
                        -- This would need to be adapted to the actual game events
                    end
                end)
            end
        end)
    end
end)

-- Auto Sell
AutoSellButton.MouseButton1Click:Connect(function()
    features.AutoSell = not features.AutoSell
    updateToggle(AutoSellButton, features.AutoSell)
    
    if features.AutoSell then
        spawn(function()
            while features.AutoSell and wait(2) do
                pcall(function()
                    -- Auto sell implementation
                    local sellEvent = game:GetService("ReplicatedStorage"):FindFirstChild("SellFish") 
                    if sellEvent then
                        -- This would sell all fish automatically
                    end
                    
                    -- Alternative method: look for sell buttons
                    for _, v in pairs(game:GetService("Workspace"):GetDescendants()) do
                        if v:IsA("TextButton") and (string.find(string.lower(v.Text), "sell") or string.find(string.lower(v.Name), "sell")) then
                            fireclickdetector(v:FindFirstChildOfType("ClickDetector") or v)
                        end
                    end
                end)
            end
        end)
    end
end)

-- Auto Perfect
AutoPerfectButton.MouseButton1Click:Connect(function()
    features.AutoPerfect = not features.AutoPerfect
    updateToggle(AutoPerfectButton, features.AutoPerfect)
    
    if features.AutoPerfect then
        -- Auto perfect catch implementation
        spawn(function()
            while features.AutoPerfect and wait(0.1) do
                pcall(function()
                    -- Look for perfect catch opportunities
                    for _, v in pairs(game:GetService("Workspace"):GetDescendants()) do
                        if v:IsA("Part") and v.Name:lower():find("perfect") then
                            -- Automatically click when perfect catch is available
                            fireclickdetector(v:FindFirstChildOfType("ClickDetector"))
                        end
                    end
                end)
            end
        end)
    end
end)

-- All Ships
AllShipsButton.MouseButton1Click:Connect(function()
    features.AllShips = not features.AllShips
    updateToggle(AllShipsButton, features.AllShips)
    
    if features.AllShips then
        pcall(function()
            -- Unlock all ships implementation
            local playerData = player:FindFirstChild("leaderstats") or player:FindFirstChild("Data")
            if playerData then
                -- This would need to be adapted to the actual game structure
            end
        end)
    end
end)

-- Teleport Functions
local function teleportToIsland(islandName)
    pcall(function()
        local targetCFrame
        
        -- Define CFrame positions for each island
        local islandPositions = {
            ["Starter Island"] = CFrame.new(0, 10, 0),
            ["Ice Island"] = CFrame.new(100, 20, 100),
            ["Volcano Island"] = CFrame.new(-100, 25, -100),
            ["Cave Island"] = CFrame.new(50, 5, 150),
            ["Sky Island"] = CFrame.new(0, 100, 0),
            ["Deep Sea Island"] = CFrame.new(0, -50, 0)
        }
        
        targetCFrame = islandPositions[islandName]
        
        if targetCFrame then
            local character = player.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = targetCFrame
            end
        end
    end)
end

-- Connect island teleport buttons
for islandName, button in pairs(islandButtons) do
    button.MouseButton1Click:Connect(function()
        teleportToIsland(islandName)
    end)
end

-- UI Management
local isMinimized = false

MinimizeButton.MouseButton1Click:Connect(function()
    if isMinimized then
        -- Expand
        MainFrame.Size = UDim2.new(0, 350, 0, 400)
        ContentFrame.Visible = true
        MinimizeButton.Text = "_"
        isMinimized = false
    else
        -- Minimize
        MainFrame.Size = UDim2.new(0, 350, 0, 40)
        ContentFrame.Visible = false
        MinimizeButton.Text = "â–¡"
        isMinimized = true
    end
end)

CloseButton.MouseButton1Click:Connect(function()
    MiwaFISH:Destroy()
end)

-- Make UI draggable
local dragging = false
local dragInput, dragStart, startPos

Header.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

Header.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Keybind to show/hide UI (F8)
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == Enum.KeyCode.F8 then
        MainFrame.Visible = not MainFrame.Visible
    end
end)

-- Initial toggle states
updateToggle(FastFishingButton, features.FastFishing)
updateToggle(AutoSellButton, features.AutoSell)
updateToggle(AutoPerfectButton, features.AutoPerfect)
updateToggle(AllShipsButton, features.AllShips)

print("MiwaFISH loaded successfully! Press F8 to toggle visibility.")
